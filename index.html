<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tex-fmt</title>
</head>
<body>
    <h1>tex-fmt</h1>

    <div>
    <button id="submitButton">Submit</button>
    <button id="copyButton">Copy Output</button>
    </div>

    <textarea id="textInput" rows="50" cols="80" placeholder="Input"></textarea>
    <textarea id="textOutput" rows="50" cols="80" placeholder="Output" readonly></textarea>

    <script type="module">
        import init, { main } from './pkg/tex_fmt.js';

        // Initialize the WebAssembly module
        (async () => {
            try {
                await init(); // Call the `init` function before using any exported functions
                console.log('WASM module initialized successfully.');
            } catch (error) {
                console.error('Error initializing WebAssembly module:', error);
                alert('Failed to initialize the WebAssembly module. Check the console for details.');
            }
        })();

        // Handle button click
        document.getElementById('submitButton').addEventListener('click', async () => {
            const inputText = document.getElementById('textInput').value;
            const outputBox = document.getElementById('textOutput');

            try {
                const result = await main(inputText); // Call the `main` function after initialization
                outputBox.value = result; // Display result in the output box
            } catch (error) {
                console.error('Error calling WebAssembly function:', error);
                alert('An error occurred. Check the console for details.');
            }
        });


// Handle button click to copy the output text to clipboard
document.getElementById('copyButton').addEventListener('click', () => {
    const outputBox = document.getElementById('textOutput');

    // Select the text in the output textarea
    outputBox.select();
    outputBox.setSelectionRange(0, 99999); // For mobile devices

    // Copy the selected text to clipboard
    try {
        document.execCommand('copy');
        alert('Output copied to clipboard!');
    } catch (err) {
        console.error('Failed to copy text: ', err);
    }
});
    </script>
</body>
</html>
